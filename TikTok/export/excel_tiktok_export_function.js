function exportTikTokToExcel(o){if(!o||o.length===0)return;const t=o[0].userName,n="TikTok",r=["Profile","TikTok","Create Date","Views","Likes","Shares","Comments","Saves","Captions"],c=o.map(e=>{const k=`https://www.tiktok.com/@${e.userName}/video/${e.code}`,d=new Date(e.createDate).toLocaleString("en-US",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0});return[e.userName,k,d,e.viewCount,e.likesCount,e.shareCount,e.commentsCount,e.savesCount,e.caption]}),a=[r,...c],i=XLSX.utils.aoa_to_sheet(a),s=XLSX.utils.book_new();XLSX.utils.book_append_sheet(s,i,n);const u=`${t} TikTok.xlsx`;XLSX.writeFile(s,u)}chrome.runtime.onMessage.addListener((o,t,n)=>{o.export_click_background_tiktok&&o.export_format==="excel"&&exportTikTokToExcel(o.sorted_data)});
